---

title: Workflow


keywords: fastai
sidebar: home_sidebar

summary: "Define static or dynamic workflow for automatically updating, training and deploying your ML model!"
description: "Define static or dynamic workflow for automatically updating, training and deploying your ML model!"
nb_path: "03_workflow.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03_workflow.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>input:</em></strong> Workflow definition parameters</p>
<p><strong><em>output:</em></strong> python or snakemake script for running the workflow</p>
<p><strong><em>description:</em></strong></p>
<p>In this notebook you define a workflow for automatically updating, training and deploying your ML project</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Import-relevant-modules">Import relevant modules<a class="anchor-link" href="#Import-relevant-modules"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">papermill</span> <span class="k">as</span> <span class="nn">pm</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Custom-magic-function-to-write-code-cell-contents-to-a-file-with-global-variables-formatted:">Custom magic function to write code cell contents to a file with global variables formatted:<a class="anchor-link" href="#Custom-magic-function-to-write-code-cell-contents-to-a-file-with-global-variables-formatted:"> </a></h2><p>This is needed so that we can create parameterizable non-python scripts from inside a notebook.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.magic</span> <span class="kn">import</span> <span class="n">register_line_cell_magic</span>

<span class="nd">@register_line_cell_magic</span>
<span class="k">def</span> <span class="nf">write_format_globals</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a function to write contents of a notebook cell to a file.</span>
<span class="sd">    To use it, call &#39;%write_format_globals filename&#39; in the first row of</span>
<span class="sd">    the cell the contents of which you want to write into a file.</span>
<span class="sd">    The code written in this cell is not run in the notebook.</span>
<span class="sd">    This means that you can also write and define non-python scripts and</span>
<span class="sd">    execute them from a notebook.</span>

<span class="sd">    You can format in global variables by placing them inside curly </span>
<span class="sd">    brackets &#39;{variable name}&#39;.</span>

<span class="sd">    Note, that your code should not include curly brackets.</span>
<span class="sd">    If curly brackets need to be written in the file, you can include </span>
<span class="sd">    them through the variable insertion:</span>

<span class="sd">    ## CELL 1:</span>
<span class="sd">    bracket_open_string = &#39;{&#39;</span>
<span class="sd">    bracket_close_string = &#39;}&#39;</span>

<span class="sd">    ## CELL 2:</span>
<span class="sd">    %write_format_globals myscriptname</span>
<span class="sd">    {bracket_open_string}</span>
<span class="sd">        # I want this part inside curly brackets!</span>
<span class="sd">    {bracket_close_string}</span>
<span class="sd">    </span>
<span class="sd">    ## file &#39;myscriptname&#39; after running the cells 1 and 2:</span>
<span class="sd">    {</span>
<span class="sd">        # I want this part inside curly brackets!</span>
<span class="sd">    }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="nb">globals</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example:-running-static-workflow-from-this-notebook">Example: running static workflow from this notebook<a class="anchor-link" href="#Example:-running-static-workflow-from-this-notebook"> </a></h2><p>(Snakemake-based dynamic workflow can not be run from inside a notebook)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Alternative-1:-Static-Executable-Workflow-with-papermill">Alternative 1: Static Executable Workflow with papermill<a class="anchor-link" href="#Alternative-1:-Static-Executable-Workflow-with-papermill"> </a></h2><p>The following script will be written into a python file, that you can run to execute the workflow.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Alternative-2:-Dynamic-Executable-Workflow-with-Snakemake">Alternative 2: Dynamic Executable Workflow with Snakemake<a class="anchor-link" href="#Alternative-2:-Dynamic-Executable-Workflow-with-Snakemake"> </a></h2><p>The following script will be written into a Snakefile, that you can run to execute the workflow.</p>

</div>
</div>
</div>
</div>
 

