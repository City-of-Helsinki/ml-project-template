---

title: Hypotheses Space


keywords: fastai
sidebar: home_sidebar



nb_path: "01_hypotheses_space.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_hypotheses_space.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Import-relevant-modules">Import relevant modules<a class="anchor-link" href="#Import-relevant-modules"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Import-toy-data-for-testing">Import toy data for testing<a class="anchor-link" href="#Import-toy-data-for-testing"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">toy_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;data/preprocessed_data/dataset_toy_switzerland_cleveland.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
<span class="n">toy_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1age</th>
      <th>x4trestbps</th>
      <th>x8thalach</th>
      <th>x10oldpeak</th>
      <th>y1num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50.0</td>
      <td>120.0</td>
      <td>158.0</td>
      <td>1.6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>57.0</td>
      <td>110.0</td>
      <td>126.0</td>
      <td>1.5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>59.0</td>
      <td>170.0</td>
      <td>140.0</td>
      <td>3.4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>41.0</td>
      <td>125.0</td>
      <td>176.0</td>
      <td>1.6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>62.0</td>
      <td>120.0</td>
      <td>134.0</td>
      <td>-0.8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>63.0</td>
      <td>150.0</td>
      <td>154.0</td>
      <td>3.7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>51.0</td>
      <td>94.0</td>
      <td>154.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>39.0</td>
      <td>94.0</td>
      <td>179.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>58.0</td>
      <td>115.0</td>
      <td>138.0</td>
      <td>0.5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>46.0</td>
      <td>100.0</td>
      <td>133.0</td>
      <td>-2.6</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Begin-with-a-simple-script-before-constructing-the-model-class">Begin with a simple script before constructing the model class<a class="anchor-link" href="#Begin-with-a-simple-script-before-constructing-the-model-class"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">toy_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># .to_numpy()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">toy_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># .to_numpy()</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">lgr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s2">&quot;scaler&quot;</span><span class="p">,</span> <span class="n">scaler</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;estimator&quot;</span><span class="p">,</span> <span class="n">lgr</span><span class="p">)])</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_train</span><span class="p">,</span>
    <span class="n">y_train</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>

<span class="n">cv</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">))</span>

<span class="c1">## optimize</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;estimator__C&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># make_pipeline(Imputer(),StandardScaler(),PCA(n_components=2),SVC(random_state=1))</span>

<span class="c1"># cv = StratifiedKFold(n_splits=5)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">pipe</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
    <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Estimator: </span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Parameters: </span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Test Score: </span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Best Training Score: </span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">gs</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s2">&quot;mean_train_score&quot;</span><span class="p">][</span><span class="n">gs</span><span class="o">.</span><span class="n">best_index_</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All Training Scores: </span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s2">&quot;mean_train_score&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All Test Scores: </span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s2">&quot;mean_test_score&quot;</span><span class="p">]))</span>
<span class="c1"># # This prints out all results during Cross-Validation in details</span>
<span class="c1"># print(&quot;All Meta Results During CV Search: \n{}\n&quot;.format(gs.cv_results_))</span>

<span class="c1"># Reset pipeline with best params</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">estimator__C</span><span class="o">=</span><span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s2">&quot;estimator__C&quot;</span><span class="p">])</span>
<span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test score with best params (should equal to Best Test Score above)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.5
[0.5  0.25]
Best Estimator: 
Pipeline(steps=[(&#39;scaler&#39;, StandardScaler()),
                (&#39;estimator&#39;, LogisticRegression(C=166.81005372000558))])

Best Parameters: 
{&#39;estimator__C&#39;: 166.81005372000558}

Best Test Score: 
0.5

Best Training Score: 
1.0

All Training Scores: 
[0.875 0.875 0.875 0.875 0.875 1.    1.    1.    1.    1.   ]

All Test Scores: 
[0.375 0.375 0.375 0.375 0.375 0.375 0.375 0.5   0.5   0.5  ]

Test score with best params (should equal to Best Test Score above)
0.5
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Define-base-class-for-hypotheses-space-/-simulations-/-analytics">Define base class for hypotheses space / simulations / analytics<a class="anchor-link" href="#Define-base-class-for-hypotheses-space-/-simulations-/-analytics"> </a></h2><blockquote><p>How to create tidy class functions?</p>
<ul>
<li>If the function performs a transformation on data, it should return the transformation. A transformation does not make changes to the model attributes.</li>
<li>If the function performs a side-effect, it should return reference to self, so that the functions can be piped. A side effect makes changes to the model attributes.</li>
<li>Transformations and side effects should not be mixed. A function should only perform one.</li>
</ul>
</blockquote>
<p>For example the pipe <code>model.optimize().predict(X, y)</code> first performs a side effect <code>.optimize()</code> and then a transformation <code>.predict(X, y)</code>.
The optimization function changes model parameters permanently, and the predict function only makes a transformation on the input data.
However, a side effect may require input and a transformation does not always require input.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MachineLearningModel" class="doc_header"><code>class</code> <code>MachineLearningModel</code><a href="https://github.com/NuuttiSten/hki_ml_project_template/tree/master/hki_ml_project_template/data.py#L26" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MachineLearningModel</code>(<strong><code>X</code></strong>, <strong><code>y</code></strong>)</p>
</blockquote>
<p>Overly simplified example for a base class: basically just function handle definitions</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Unit-test-base-class">Unit test base class<a class="anchor-link" href="#Unit-test-base-class"> </a></h2><p>Purpose of unit testing is to cover all possible excecution paths in code.
Unit testing helps developers to avoid and identify bugs in code.</p>
<p>In this example python built-in <code>assert</code> is used for unit tests.
The line after <code>assert</code> should return <code>True</code>, i.e. a non-zero object.
0 or None object will raise an <code>AssertionError</code>. Note that <code>np.nan</code> does not raise the error.</p>
<p>At the moment, nbdev considers all cells that do not have <code># export</code> tag as tests. 
This is handy because you can now keep all your tests in the same file (notebook) with the code and documentation.
The downside is, however, that at the moment there is no official solution for monitoring test coverage. 
If test coverage is required, one option would be to implement tests with  <code>pytest</code> or <code>unittest</code> and export the tests to separate test.py file.
Nbdev allows marking slow cells with <code># slow</code> tag so that they can be left out from commit test runs to speed up testing.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mlmodel</span> <span class="o">=</span> <span class="n">MachineLearningModel</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># test get_data</span>
<span class="k">assert</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<span class="k">assert</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># test __create_test_train_data and get_train_test_data</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
    <span class="mi">10</span> <span class="o">*</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">get_train_test_data</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mi">10</span> <span class="o">/</span> <span class="n">mlmodel</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>

<span class="c1"># test set_data</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="n">MachineLearningModel</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">y</span><span class="p">)</span>
    <span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">)</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Define-subclasses-&amp;-functions">Define subclasses &amp; functions<a class="anchor-link" href="#Define-subclasses-&amp;-functions"> </a></h2><p>A subclass or child class inherits all attributes and functions of a parent class, but may also have additional functions defined.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LogisticRegressionClassifier" class="doc_header"><code>class</code> <code>LogisticRegressionClassifier</code><a href="https://github.com/NuuttiSten/hki_ml_project_template/tree/master/hki_ml_project_template/data.py#L90" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LogisticRegressionClassifier</code>(<strong><code>X</code></strong>, <strong><code>y</code></strong>) :: <a href="/hki_ml_project_template/hypotheses_space.html#MachineLearningModel"><code>MachineLearningModel</code></a></p>
</blockquote>
<p>Logistic regression classifier</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># print(&quot;Best Estimator: \n{}\n&quot;.format(gs.best_estimator_))</span>
<span class="c1"># print(&quot;Best Parameters: \n{}\n&quot;.format(gs.best_params_))</span>
<span class="c1"># print(&quot;Best Test Score: \n{}\n&quot;.format(gs.best_score_))</span>
<span class="c1"># print(</span>
<span class="c1">#    &quot;Best Training Score: \n{}\n&quot;.format(</span>
<span class="c1">#        gs.cv_results_[&quot;mean_train_score&quot;][gs.best_index_]</span>
<span class="c1">#    )</span>
<span class="c1"># )</span>
<span class="c1"># print(&quot;All Training Scores: \n{}\n&quot;.format(gs.cv_results_[&quot;mean_train_score&quot;]))</span>
<span class="c1"># print(&quot;All Test Scores: \n{}\n&quot;.format(gs.cv_results_[&quot;mean_test_score&quot;]))</span>
<span class="c1"># # This prints out all results during Cross-Validation in details</span>
<span class="c1"># print(&quot;All Meta Results During CV Search: \n{}\n&quot;.format(gs.cv_results_))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Unit-test-subclasses">Unit test subclasses<a class="anchor-link" href="#Unit-test-subclasses"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lgr_model</span> <span class="o">=</span> <span class="n">LogisticRegressionClassifier</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># test fit</span>
<span class="k">try</span><span class="p">:</span>  <span class="c1"># fit should be called before predict or score</span>
    <span class="n">lgr_model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="k">except</span><span class="p">:</span> <span class="c1"># yes, you can also test what should not work!</span>
    <span class="k">pass</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">lgr_model</span><span class="o">.</span><span class="n">score</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="n">lgr_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>  <span class="c1"># should not break</span>

<span class="c1"># test predict</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;predicted: </span><span class="si">{</span><span class="n">lgr_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;true     : </span><span class="si">{</span><span class="n">y</span><span class="p">[::</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># test score</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;score: </span><span class="si">{</span><span class="n">lgr_model</span><span class="o">.</span><span class="n">score</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># test optimize</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimizing model&quot;</span><span class="p">)</span>
<span class="n">lgr_model</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;predicted: </span><span class="si">{</span><span class="n">lgr_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;true     : </span><span class="si">{</span><span class="n">y</span><span class="p">[::</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;score: </span><span class="si">{</span><span class="n">lgr_model</span><span class="o">.</span><span class="n">score</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># test get_params</span>
<span class="n">lgr_model</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>predicted: [1 1 1 1 1 1 0 0 1 1]
true     : [0 0 1 1 1 1 0 0 1 1]
score: {&#39;train_score&#39;: 1.0, &#39;test_score&#39;: 0.5}
Optimizing model
predicted: [1 0 1 1 1 1 0 0 1 1]
true     : [0 0 1 1 1 1 0 0 1 1]
score: {&#39;train_score&#39;: 1.0, &#39;test_score&#39;: 0.5}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;memory&#39;: None,
 &#39;steps&#39;: [(&#39;scaler&#39;, StandardScaler()),
  (&#39;estimator&#39;, LogisticRegression(C=166.81005372000558))],
 &#39;verbose&#39;: False,
 &#39;scaler&#39;: StandardScaler(),
 &#39;estimator&#39;: LogisticRegression(C=166.81005372000558),
 &#39;scaler__copy&#39;: True,
 &#39;scaler__with_mean&#39;: True,
 &#39;scaler__with_std&#39;: True,
 &#39;estimator__C&#39;: 166.81005372000558,
 &#39;estimator__class_weight&#39;: None,
 &#39;estimator__dual&#39;: False,
 &#39;estimator__fit_intercept&#39;: True,
 &#39;estimator__intercept_scaling&#39;: 1,
 &#39;estimator__l1_ratio&#39;: None,
 &#39;estimator__max_iter&#39;: 100,
 &#39;estimator__multi_class&#39;: &#39;auto&#39;,
 &#39;estimator__n_jobs&#39;: None,
 &#39;estimator__penalty&#39;: &#39;l2&#39;,
 &#39;estimator__random_state&#39;: None,
 &#39;estimator__solver&#39;: &#39;lbfgs&#39;,
 &#39;estimator__tol&#39;: 0.0001,
 &#39;estimator__verbose&#39;: 0,
 &#39;estimator__warm_start&#39;: False}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualize-model-behaviour-with-toy-data">Visualize model behaviour with toy data<a class="anchor-link" href="#Visualize-model-behaviour-with-toy-data"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Output-of-this-notebook">Output of this notebook<a class="anchor-link" href="#Output-of-this-notebook"> </a></h2><p>The result of this notebook is a collection methods ready for evaluation with the real data.</p>
<p>the methods should be exported with <code>nbdev_build_lib</code>, but in the future this will be automatically handled by the pipeline</p>

</div>
</div>
</div>
</div>
 

